<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Edify Music</title>

	<link rel="stylesheet" href="css/font-awesome.min.css"/>
	<link rel="stylesheet" href="css/bootstrap.min.css"/>
	<link href="css/abcjs-midi.css" media="all" rel="stylesheet" type="text/css" />
	<script src="js/abcjs_editor_midi_3.1.1-min.js" type="text/javascript"></script>
	<style>
		.abcjs-inline-midi {
			max-width: 960px;
		}
    textarea {
        display: block;
        width: 100%;
        -webkit-box-sizing: border-box;
           -moz-box-sizing: border-box;
                box-sizing: border-box;
    }
	</style>
</head>
<body>
  

    <!-- Static navbar -->
    <nav class="navbar navbar-default navbar-static-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#"><span color="blue">edify</span> Music <i class="fa fa-music" aria-hidden="true"></i></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#contact">Help</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Pre-loaded Songs <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="#">Action</a></li>
                <li><a href="#">Another action</a></li>
                <li><a href="#">Something else here</a></li>
                <li role="separator" class="divider"></li>
                <li class="dropdown-header">National Anthems</li>
                <li><a id="ghana_anthem" href="#">Ghana</a></li>
                <li><a href="#">Liberia</a></li>
              </ul>
            </li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>


    <div class="container">

      <!-- Main component for a primary marketing message or call to action -->
      <div class="jumbotron">
        <p>Type or paste an abc tune in the area below and see it rendered as you type. Also notice that you can click on the drawn notes and
        	see the place in the text where that note is defined.</p>
      </div>

<textarea name="abc" id="abc" rows="15">
X: 1
T: God Bless Our Homeland Ghana
C: Philip Gbeho
M: C
L: 1/4
Q: 1/4=70
K: Ab
c c3/4c/8 e (A3/4A/8)|d2 c3/2 A/2|f e d c|B B B2|c c3/4c/8 e A|
w: God bless our home-land|Gha-na And|make our na-tion|great and strong,|Bold to de-fend for-
d2 c3/2 c/2|B e (3(e/2f/2)e/2 (3(=d/2c/2)d/2|e3 (3(E/2F/2)G/2|A (A3/4B/4) c (c3/4B/4)|=A (B3/4c/4) d (3(F/2G/2)=A/2|
w: e-ver The|cause of Freedom and|Right; Fill our|hearts with true hu-|mi-li-ty, Make us|
B (B3/4c/4) d =d|e (e3/4d/4) c3/2 A/2|f e d c|B3/4A/4 G3/4F/4 E3/4E/4 F3/4G/4|A c (3(c/2d/2c/2) (3(B/2A/2)B/2|
w: che-rish fear-less|ho-nes-ty, And| help us to re-|sist op-pres-sors' rule With all our|will and might e- ver-|
(A3 A3/4)A/4|f e d c|B3/4A/4 G3/4F/4 E3/4E/4 F3/4G/4|A c (3(c/2d/2c/2) (3(B/2A/2)B/2|A4|]
w: more. And|help us to re-|sist op-pres-sors' rule With all our|will and might e- ver-|more.|
</textarea>

      <div id="midi"></div>
      <div id="midi-download"></div><br/>
      <div id="abc-file-download"><button type="button" class="btn btn-success" value="save" id="save"><i class="fa fa-file-text-o"></i> Download as text file.</button></div>
      <div id="warnings"></div>
      <div id="music"></div>
      <div id="paper0"></div>
      <div id="paper1"></div>
      <div id="paper2"></div>
      <div id="paper3"></div>
      <div id="selection"></div>

    </div> <!-- /container -->  
    
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>  
<script type="text/javascript">
	function selectionCallback(abcelem) {
		var note = {};
		for (var key in abcelem) {
			if (abcelem.hasOwnProperty(key) && key !== "abselem")
				note[key] = abcelem[key];
		}
		console.log(abcelem);
		var el = document.getElementById("selection");
		el.innerHTML = "<b>selectionCallback parameter:</b><br>" + JSON.stringify(note);
	}

	function initEditor() {
		new ABCJS.Editor("abc", { paper_id: "paper0",
			generate_midi: true,
			midi_id:"midi",
			midi_download_id: "midi-download",
			generate_warnings: true,
			warnings_id:"warnings",
			midi_options: {
				generateDownload: false
			},
			render_options: {
				listener: { highlight: selectionCallback }
			}
		});
	}

	window.addEventListener("load", initEditor, false);

  function saveTextAsFile() {
    var textToWrite = document.getElementById('abc').value;
    var textFileAsBlob = new Blob([ textToWrite ], { type: 'text/plain' });
    var fileNameToSaveAs = "song.txt";
  
    var downloadLink = document.createElement("a");
    downloadLink.download = fileNameToSaveAs;
    downloadLink.innerHTML = "Download as .abc File";
    if (window.webkitURL != null) {
      // Chrome allows the link to be clicked without actually adding it to the DOM.
      downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
    } else {
      // Firefox requires the link to be added to the DOM before it can be clicked.
      downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
      downloadLink.onclick = destroyClickedElement;
      downloadLink.style.display = "none";
      document.body.appendChild(downloadLink);
    }
  
    downloadLink.click();
  }
  
  var button = document.getElementById('save');
  button.addEventListener('click', saveTextAsFile);
  
  function destroyClickedElement(event) {
    // remove the link from the DOM
    document.body.removeChild(event.target);
  }	

  $(document).ready(function(){
    $("#ghana_anthem").click(function(){
      $('#abc').text('X: 1\nT: Cooley\'s\nM: 4/4\nL: 1/8\nR: reel\nK: Emin\n|:D2|EB{c}BA B2 EB|~B2 AB dBAG|FDAD BDAD|FDAD dAFD|\nEBBA B2 EB|B2 AB defg|afe^c dBAF|DEFD E2:|\n|:gf|eB B2 efge|eB B2 gedB|A2 FA DAFA|A2 FA defg|\neB B2 eBgB|eB B2 defg|afe^c dBAF|DEFD E2:|');
      $("#abc").focus();
    });
  });  
	
</script>
<!-- Placed at the end of the document so the pages load faster -->
</body>
</html>